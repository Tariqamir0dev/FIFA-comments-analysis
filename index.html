<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ‚Ø±ÙŠØ± ØªØ­Ù„ÙŠÙ„ Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ø¹Ø·Ø§Ø±Ø© ÙÙŠÙØ§ Ø§Ù„Ø­Ù…Ø¯Ø§Ù†ÙŠØ©</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Arial', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .report-container {
            max-width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: visible;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .report-container.downloading {
            width: 210mm !important;
            max-width: 210mm !important;
            height: auto !important;
            overflow: visible !important;
            position: static !important;
            transform: none !important;
        }

        .header {
            background: linear-gradient(135deg, #665549 0%, #a9a569 100%);
            color: white;
            padding: 25px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="30" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="2"/><circle cx="30" cy="30" r="15" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/><circle cx="70" cy="70" r="20" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1.5"/></svg>') repeat;
            opacity: 0.3;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header-author {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .subtitle {
            font-size: 1em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .report-date {
            background: rgba(255,255,255,0.2);
            padding: 6px 15px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
            margin-top: 8px;
            font-size: 0.9em;
        }

        .content {
            padding: 20px 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
            position: relative;
            flex-shrink: 0;
        }

        .section h2 {
            color: #665549;
            font-size: 1.3em;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 2px solid #a9a569;
            position: relative;
        }

        .section h2::before {
            content: '';
            position: absolute;
            left: 0;
            bottom: -3px;
            width: 50px;
            height: 3px;
            background: #665549;
            border-radius: 2px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 10px 0;
        }

        .stat-card {
            color: white;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(0);
            transition: transform 0.3s ease;
        }

        .stat-card.total {
            background: linear-gradient(135deg, #665549 0%, #a9a569 100%);
        }

        .stat-card.positive {
            background: linear-gradient(135deg, #a9a569 0%, #c4c48a 100%);
        }

        .stat-card.negative {
            background: linear-gradient(135deg, #665549 0%, #8b7355 100%);
        }

        .stat-card.satisfaction {
            background: linear-gradient(135deg, #a9a569 0%, #665549 100%);
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 4px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .stat-label {
            font-size: 0.8em;
            opacity: 0.9;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .analysis-card {
            background: white;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
            border-left: 3px solid #a9a569;
        }

        .analysis-card.negative {
            border-left-color: #665549;
        }

        .analysis-card h3 {
            color: #665549;
            font-size: 1.1em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .icon {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 12px;
        }

        .positive-icon {
            background: #a9a569;
        }

        .negative-icon {
            background: #665549;
        }

        .improvement-icon {
            background: #8b7355;
        }

        .analysis-list {
            list-style: none;
        }

        .analysis-list li {
            margin: 4px 0;
            padding: 6px;
            background: #f8f9fa;
            border-radius: 6px;
            border-right: 3px solid #a9a569;
            font-size: 0.8em;
            line-height: 1.3;
        }

        .rating-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .rating-container {
            text-align: center;
            margin: 10px 0;
            padding: 15px;
            background: linear-gradient(135deg, #a9a569 0%, #c4c48a 50%, #c4c48a 100%);
            border-radius: 12px;
            position: relative;
        }


        .rating-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #665549 0%, #8b7355 36%, #a9a569 72%, #a9a569 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            position: relative;
        }

        .rating-inner {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .rating-score {
            font-size: 2em;
            font-weight: bold;
            color: #665549;
            line-height: 1;
        }

        .rating-total {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 2px;
        }

        .rating-description {
            font-size: 1em;
            color: #665549;
            font-weight: bold;
            margin-top: 8px;
        }

        .recommendations {
            background: linear-gradient(135deg, #665549 0%, #a9a569 100%);
            color: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
        }

        .recommendations h3 {
            font-size: 1.2em;
            margin-bottom: 10px;
            text-align: center;
        }

        .recommendation-item {
            background: rgba(255,255,255,0.15);
            margin: 8px 0;
            padding: 10px;
            border-radius: 6px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .recommendation-item h4 {
            font-size: 1em;
            margin-bottom: 6px;
            color: #fff;
        }

        .footer {
            background: #665549;
            color: white;
            text-align: center;
            padding: 15px;
            margin-top: 10px;
            flex-shrink: 0;
        }

        .download-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #a9a569;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 5px 15px rgba(169, 165, 105, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .download-btn:hover {
            background: #665549;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 85, 73, 0.4);
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .stat-card {
                padding: 12px;
            }
            
            .stat-number {
                font-size: 2em;
            }
            
            .stat-label {
                font-size: 0.9em;
            }
            
            .analysis-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .rating-section {
                gap: 20px;
            }
            
            .header-author {
                position: static;
                margin-bottom: 15px;
                text-align: center;
                background: rgba(255,255,255,0.15);
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .download-btn {
                display: none;
            }
            
            .report-container {
                box-shadow: none;
                border-radius: 0;
                max-width: none;
                margin: 0;
                height: auto !important;
                min-height: auto !important;
                overflow: visible !important;
            }
            
            .content {
                height: auto !important;
                overflow: visible !important;
            }
            
            .section {
                break-inside: avoid;
                page-break-inside: avoid;
            }
        }

        .highlight-box {
            background: linear-gradient(135deg, #a9a569 0%, #c4c48a 100%);
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            border-left: 3px solid #665549;
        }

        .employee-highlight {
            background: linear-gradient(135deg, #a9a569 0%, #c4c48a 100%);
            border-radius: 8px;
            padding: 10px;
            margin: 8px 0;
            text-align: center;
            border: 2px solid #665549;
        }

        .employee-highlight h4 {
            color: #665549;
            font-size: 1em;
            margin-bottom: 6px;
        }

        .star-rating {
            color: #665549;
            font-size: 1em;
            margin: 6px 0;
        }
    </style>
</head>
<body>
    <button class="download-btn" onclick="downloadAsImage()">ğŸ“¸ ØªØ­Ù…ÙŠÙ„ ÙƒØµÙˆØ±Ø©</button>
    
    <div class="report-container" id="report">
        <div class="header">
            <div class="header-author">Ø¥Ø¹Ø¯Ø§Ø¯: Ù… / Ø·Ø§Ø±Ù‚ Ø¹Ø§Ù…Ø±</div>
            <div class="header-content">
                <h1>ğŸ“Š ØªÙ‚Ø±ÙŠØ± ØªØ­Ù„ÙŠÙ„ Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h1>
                <div class="subtitle">Ø¹Ø·Ø§Ø±Ø© ÙÙŠÙØ§ - ÙØ±Ø¹ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©</div>
                <div class="report-date">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: Ø³Ø¨ØªÙ…Ø¨Ø± 2025</div>
            </div>
        </div>

        <div class="content">
            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¹Ø§Ù…Ø© -->
            <div class="section">
                <h2>ğŸ“ˆ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h2>
                <div class="stats-grid">
                    <div class="stat-card total">
                        <div class="stat-number">27</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</div>
                    </div>
                    <div class="stat-card positive">
                        <div class="stat-number">26</div>
                        <div class="stat-label">Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©</div>
                    </div>
                    <div class="stat-card negative">
                        <div class="stat-number">1</div>
                        <div class="stat-label">Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</div>
                    </div>
                    <div class="stat-card satisfaction">
                        <div class="stat-number">96%</div>
                        <div class="stat-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø±Ø¶Ø§</div>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ -->
            <div class="section">
                <h2>ğŸ¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„ÙØ±Ø¹</h2>
                <div class="rating-section">
                <div class="rating-container">
                    <div class="rating-circle">
                        <div class="rating-inner">
                            <div class="rating-score">9.6</div>
                            <div class="rating-total">/10</div>
                        </div>
                    </div>
                    <div class="rating-description">ØªÙ‚ÙŠÙŠÙ… Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ø§Ù‹ - Ù…Ù† Ø£ÙØ¶Ù„ Ø§Ù„ÙØ±ÙˆØ¹</div>
                    <div class="star-rating">â˜…â˜…â˜…â˜…â˜…</div>
                    </div>
                    
                </div>
            </div>

            <!-- ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ§Øª ÙˆØ§Ù„Ø³Ù„Ø¨ÙŠØ§Øª -->
            <div class="section">
                <h2>âš–ï¸ ØªØ­Ù„ÙŠÙ„ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø¶Ø¹Ù</h2>
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h3><span class="icon positive-icon">+</span>Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©</h3>
                        <ul class="analysis-list">
                            <li><strong>Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªÙ†ÙˆØ¹Ø©:</strong> ØªÙ…ÙˆØ± ÙˆØ¨Ù‡Ø§Ø±Ø§Øª ÙˆÙ…ÙƒØ³Ø±Ø§Øª ÙˆÙ…Ø¹Ø§Ù…ÙŠÙ„ ÙˆÙ…Ù†ØªØ¬Ø§Øª ØªØ¬Ù…ÙŠÙ„ÙŠØ©</li>
                            <li><strong>Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©:</strong> Ù…ÙˆØ¸ÙÙŠÙ† Ù…ØªÙ…ÙŠØ²ÙŠÙ† ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</li>
                            <li><strong>Ø§Ù„Ù†Ø¸Ø§ÙØ© ÙˆØ§Ù„ØªØ±ØªÙŠØ¨:</strong> Ù…Ø¹Ø§ÙŠÙŠØ± Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø­Ù„</li>
                            <li><strong>Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶:</strong> Ø£Ø³Ø¹Ø§Ø± Ø¬ÙŠØ¯Ø© Ù†Ø³Ø¨ÙŠØ§Ù‹ Ù…Ø¹ Ø¹Ø±ÙˆØ¶ Ù…ØºØ±ÙŠØ©</li>
                            <li><strong>Ù…ÙˆØ¸ÙÙˆÙ† Ù…ØªÙ…ÙŠØ²ÙˆÙ†:</strong> Ø¹Ù„ÙŠ Ø§Ù„Ø­Ø±ÙŠØ¨ÙŠ ÙˆØ³Ø§Ù…ÙŠ ÙˆÙŠÙˆÙ†Ø³ ÙˆØ§Ù„Ø¨Ø±Ø§Ø¡</li>
                        </ul>
                    </div>
                    
                    <div class="analysis-card negative">
                        <h3><span class="icon negative-icon">-</span>Ù†Ù‚Ø§Ø· ØªØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†</h3>
                        <ul class="analysis-list">
                            <li><strong>Ø·Ø±ÙŠÙ‚Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±:</strong> Ù„Ø¨Ø³ ÙÙŠ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ ÙˆØ§Ù„Ø®ØµÙˆÙ…Ø§Øª ÙŠØ­ØªØ§Ø¬ ØªÙˆØ¶ÙŠØ­ Ø£ÙƒØ«Ø±</li>
                        </ul>
                    </div>
                </div>

                <!-- ØªØ³Ù„ÙŠØ· Ø§Ù„Ø¶ÙˆØ¡ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…ØªÙ…ÙŠØ² -->
                <div class="employee-highlight">
                    <h4>ğŸ† Ø§Ù„Ù…ÙˆØ¸ÙÙˆÙ† Ø§Ù„Ù…ØªÙ…ÙŠØ²ÙˆÙ†</h4>
                    <p><strong>Ø¹Ù„ÙŠ Ø§Ù„Ø­Ø±ÙŠØ¨ÙŠ - Ø³Ø§Ù…ÙŠ - ÙŠÙˆÙ†Ø³ - Ø§Ù„Ø¨Ø±Ø§Ø¡</strong></p>
                    <p>Ø¹Ù„ÙŠ Ø§Ù„Ø­Ø±ÙŠØ¨ÙŠ Ø£Ø´Ø§Ø¯ Ø¨Ù‡ Ø¹Ø¯Ø© Ø¹Ù…Ù„Ø§Ø¡ Ù„Ø®Ø¯Ù…ØªÙ‡ Ø§Ù„Ø±Ø§Ù‚ÙŠØ© ÙˆØ£Ø®Ù„Ø§Ù‚Ù‡ Ø§Ù„Ø¹Ø§Ù„ÙŠØ©ØŒ ÙˆØ³Ø§Ù…ÙŠ Ù…Ø­Ø¨ÙˆØ¨ ÙˆÙ„Ø¨Ù‚ØŒ ÙˆÙŠÙˆÙ†Ø³ ÙˆØ§Ù„Ø¨Ø±Ø§Ø¡ ØªÙ…ÙŠØ²ÙˆØ§ Ø¨Ø®Ø¯Ù…ØªÙ‡Ù… Ø§Ù„Ø±Ø§Ù‚ÙŠØ©</p>
                    <div class="star-rating">â˜…â˜…â˜…â˜…â˜…</div>
                </div>
            </div>

            <!-- Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª -->
            <div class="recommendations">
                <h3>ğŸ¯ Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</h3>
                
                <div class="recommendation-item">
                    <h4>1ï¸âƒ£ ØªÙˆØ¶ÙŠØ­ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø®ØµÙˆÙ…Ø§Øª</h4>
                    <p>ØªÙˆØ¶ÙŠØ­ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¶Ø±Ø§Ø¦Ø¨ ÙˆØ§Ù„Ø®ØµÙˆÙ…Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ù„Ø¨Ø³</p>
                </div>

                <div class="recommendation-item">
                    <h4>2ï¸âƒ£ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h4>
                    <p>ÙˆØ¶Ø¹ Ù„Ø§ÙØªØ© Ø£Ùˆ ØªÙˆØ¶ÙŠØ­ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙŠØ´Ø±Ø­ Ø·Ø±ÙŠÙ‚Ø© Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ø®ØµÙ… ÙˆØ§Ù„Ø¶Ø±ÙŠØ¨Ø©</p>
                </div>

                <div class="recommendation-item">
                    <h4>3ï¸âƒ£ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h4>
                    <p>Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ø§Ù„ÙˆØ¯ÙŠ ÙˆØ§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</p>
                </div>

                <div class="recommendation-item">
                    <h4>4ï¸âƒ£ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙ…ÙŠØ²</h4>
                    <p>Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ Ù†ÙØ³ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ØªÙ…ÙŠØ² Ø§Ù„Ø­Ø§Ù„ÙŠ</p>
                </div>
            </div>

            <!-- Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© -->
            <div class="highlight-box">
                <h3 style="color: #e91e63; text-align: center; margin-bottom: 15px;">ğŸ“‹ Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h3>
                <p style="text-align: center; font-size: 1.1em; line-height: 1.8;">
                    <strong>Ø¹Ø·Ø§Ø±Ø© ÙÙŠÙØ§ - ÙØ±Ø¹ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©</strong> ØªØ­ØµÙ„ Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ… <strong>9.6/10</strong><br>
                    Ø§Ù„ÙØ±Ø¹ ÙŠÙØ¹Ø¯ Ù…Ù† Ø£ÙØ¶Ù„ ÙØ±ÙˆØ¹ Ø¹Ø·Ø§Ø±Ø© ÙÙŠÙØ§ Ù…Ø¹ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ø¬Ø¯Ø§Ù‹ (96%) Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø© ÙˆØ§Ù„Ù†Ø¸Ø§ÙØ©.<br>
                    Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ±Ø© Ø¨Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ù‡ÙŠ Ø¶Ø±ÙˆØ±Ø© ØªÙˆØ¶ÙŠØ­ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ù„ØªØ¬Ù†Ø¨ Ø³ÙˆØ¡ Ø§Ù„ÙÙ‡Ù….
                </p>
            </div>
        </div>

        <div class="footer">
            <p>ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ 27 ØªØ¹Ù„ÙŠÙ‚ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø®Ù„Ø§Ù„ Ø§Ù„ÙØªØ±Ø© Ù…Ù† Ø£ØºØ³Ø·Ø³ Ø¥Ù„Ù‰ Ø³Ø¨ØªÙ…Ø¨Ø± 2025</p>
            <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                ğŸ“§ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„: 0535858440 | ğŸŒ Ø¥Ø¯Ø§Ø±Ø© Ø¹Ø·Ø§Ø±Ø© ÙÙŠÙØ§
            </p>
        </div>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // Ø¯Ø§Ù„Ø© Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø·ÙˆØ·
        async function ensureFontsLoaded() {
            try {
                await document.fonts.ready;
                console.log('Ø§Ù„Ø®Ø·ÙˆØ· Ø¬Ø§Ù‡Ø²Ø©');
                
                // Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„ØªØ£ÙƒØ¯
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø®Ø· Cairo
                const testElement = document.createElement('div');
                testElement.style.fontFamily = 'Cairo, Arial, sans-serif';
                testElement.style.position = 'absolute';
                testElement.style.left = '-9999px';
                testElement.textContent = 'Test';
                document.body.appendChild(testElement);
                
                const computedStyle = window.getComputedStyle(testElement);
                const fontFamily = computedStyle.fontFamily;
                
                document.body.removeChild(testElement);
                
                console.log('Ø®Ø· Ù…Ø­Ù…Ù„:', fontFamily);
                return true;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø·ÙˆØ·:', error);
                return false;
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯
        async function ensureResourcesLoaded() {
            const promises = [];
            
            // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø·ÙˆØ·
            promises.push(ensureFontsLoaded());
            
            // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                if (!img.complete) {
                    promises.push(new Promise(resolve => {
                        img.onload = resolve;
                        img.onerror = resolve;
                    }));
                }
            });
            
            // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ CSS
            promises.push(new Promise(resolve => {
                if (document.readyState === 'complete') {
                    resolve();
                } else {
                    window.addEventListener('load', resolve);
                }
            }));
            
            await Promise.all(promises);
            console.log('Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ù…Ø­Ù…Ù„Ø©');
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¹Ù†ØµØ±
        function validateElement(element) {
            if (!element) {
                throw new Error('Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
            }
            
            const rect = element.getBoundingClientRect();
            if (rect.width === 0 || rect.height === 0) {
                throw new Error('Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù‡ Ø£Ø¨Ø¹Ø§Ø¯ ØµÙØ±');
            }
            
            const computedStyle = window.getComputedStyle(element);
            if (computedStyle.display === 'none') {
                throw new Error('Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ÙÙŠ');
            }
            
            if (computedStyle.visibility === 'hidden') {
                throw new Error('Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…Ø±Ø¦ÙŠ');
            }
            
            console.log('Ø§Ù„Ø¹Ù†ØµØ± ØµØ§Ù„Ø­ Ù„Ù„ØªØ­Ù…ÙŠÙ„');
            return true;
        }
        async function downloadAsImage() {
            try {
                console.log('Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù…ÙŠÙ„...');
                
            const element = document.getElementById('report');
                if (!element) {
                    alert('Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ØµØ±');
                    return;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¹Ù†ØµØ±
                validateElement(element);
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
                const loadingBtn = document.querySelector('.download-btn');
                const originalText = loadingBtn.textContent;
                loadingBtn.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
                loadingBtn.disabled = true;
                
                // Ø­ÙØ¸ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£ØµÙ„ÙŠØ©
                const originalStyles = {
                    height: element.style.height,
                    minHeight: element.style.minHeight,
                    maxHeight: element.style.maxHeight,
                    overflow: element.style.overflow,
                    width: element.style.width,
                    maxWidth: element.style.maxWidth,
                    position: element.style.position,
                    transform: element.style.transform
                };
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„
                element.classList.add('downloading');
                element.style.height = 'auto';
                element.style.minHeight = 'auto';
                element.style.maxHeight = 'none';
                element.style.overflow = 'visible';
                element.style.width = '210mm';
                element.style.maxWidth = '210mm';
                element.style.position = 'static';
                element.style.transform = 'none';
                
                // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯
                await ensureResourcesLoaded();
                
                // Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØªØ­Ù…ÙŠÙ„
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠØ©
                const rect = element.getBoundingClientRect();
                const scrollWidth = element.scrollWidth;
                const scrollHeight = element.scrollHeight;
                
                console.log('Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø¹Ù†ØµØ±:', {
                    width: rect.width,
                    height: rect.height,
                    scrollWidth: scrollWidth,
                    scrollHeight: scrollHeight
                });
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ø¹ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ø®ØªÙ„ÙØ©
                let canvas;
                let attempts = 0;
                const maxAttempts = 3;
                
                while (attempts < maxAttempts) {
                    try {
                        console.log(`Ù…Ø­Ø§ÙˆÙ„Ø© ${attempts + 1} Ù…Ù† ${maxAttempts}`);
                        
                        const options = {
                            scale: attempts === 0 ? 1.2 : 1,
                useCORS: true,
                backgroundColor: '#ffffff',
                            allowTaint: true,
                            foreignObjectRendering: true,
                            logging: true,
                            removeContainer: false,
                scrollX: 0,
                            scrollY: 0,
                            width: 794, // A4 width in pixels
                            height: Math.max(scrollHeight, 1123), // A4 height or content height
                            windowWidth: 794,
                            windowHeight: Math.max(scrollHeight, 1123),
                            onclone: function(clonedDoc) {
                                console.log('Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø³Ø®Ø©...');
                                
                                // Ø¥Ø²Ø§Ù„Ø© Ù‚ÙŠÙˆØ¯ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ù…Ù† Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                                const clonedElement = clonedDoc.getElementById('report');
                                if (clonedElement) {
                                    clonedElement.style.height = 'auto';
                                    clonedElement.style.minHeight = 'auto';
                                    clonedElement.style.maxHeight = 'none';
                                    clonedElement.style.overflow = 'visible';
                                    clonedElement.style.width = '210mm';
                                    clonedElement.style.maxWidth = '210mm';
                                    clonedElement.style.position = 'static';
                                    clonedElement.style.transform = 'none';
                                }
                                
                                // Ø¥Ø²Ø§Ù„Ø© Ù‚ÙŠÙˆØ¯ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±
                                const allElements = clonedDoc.querySelectorAll('*');
                                allElements.forEach(el => {
                                    el.style.height = 'auto';
                                    el.style.minHeight = 'auto';
                                    el.style.maxHeight = 'none';
                                    el.style.overflow = 'visible';
                                    el.style.position = 'static';
                                    el.style.transform = 'none';
                                });
                                
                                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø®Ø·ÙˆØ· Ù…Ø­Ù…Ù„Ø©
                                const style = clonedDoc.createElement('style');
                                style.textContent = `
                                    * {
                                        font-family: 'Cairo', Arial, sans-serif !important;
                                    }
                                    .report-container {
                                        width: 210mm !important;
                                        max-width: 210mm !important;
                                        height: auto !important;
                                        overflow: visible !important;
                                    }
                                `;
                                clonedDoc.head.appendChild(style);
                                
                                console.log('ØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø³Ø®Ø©');
                            }
                        };
                        
                        canvas = await html2canvas(element, options);
                        console.log('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Canvas Ø¨Ù†Ø¬Ø§Ø­');
                        break;
                        
                    } catch (error) {
                        console.error(`ÙØ´Ù„Øª Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ${attempts + 1}:`, error);
                        attempts++;
                        if (attempts < maxAttempts) {
                            await new Promise(resolve => setTimeout(resolve, 1000));
                        }
                    }
                }
                
                if (!canvas) {
                    throw new Error('ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Canvas Ø¨Ø¹Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª');
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Canvas ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø­ØªÙˆÙ‰
                if (!canvas || canvas.width === 0 || canvas.height === 0) {
                    throw new Error('Canvas ÙØ§Ø±Øº Ø£Ùˆ Ø£Ø¨Ø¹Ø§Ø¯Ù‡ ØµÙØ±');
                }
                
                const ctx = canvas.getContext('2d');
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                let hasContent = false;
                let nonWhitePixels = 0;
                
                for (let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    
                    if (r !== 255 || g !== 255 || b !== 255) {
                        hasContent = true;
                        nonWhitePixels++;
                    }
                }
                
                console.log(`Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙƒØ³Ù„Ø§Øª ØºÙŠØ± Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡: ${nonWhitePixels}`);
                
                if (!hasContent || nonWhitePixels < 100) {
                    throw new Error(`Canvas ÙØ§Ø±Øº Ø£Ùˆ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø­ØªÙˆÙ‰ Ù‚Ù„ÙŠÙ„ Ø¬Ø¯Ø§Ù‹ - Ø§Ù„Ø¨ÙƒØ³Ù„Ø§Øª: ${nonWhitePixels}`);
                }
                
                console.log('Canvas ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø­ØªÙˆÙ‰ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...');
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
            const link = document.createElement('a');
            link.download = 'ØªÙ‚Ø±ÙŠØ±_Ø¹Ø·Ø§Ø±Ø©_ÙÙŠÙØ§_Ø§Ù„Ø­Ù…Ø¯Ø§Ù†ÙŠØ©.png';
            link.href = canvas.toDataURL('image/png', 1.0);
            link.click();
                
                console.log('ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­');
                
                // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£ØµÙ„ÙŠØ©
                element.classList.remove('downloading');
                element.style.height = originalStyles.height;
                element.style.minHeight = originalStyles.minHeight;
                element.style.maxHeight = originalStyles.maxHeight;
                element.style.overflow = originalStyles.overflow;
                element.style.width = originalStyles.width;
                element.style.maxWidth = originalStyles.maxWidth;
                element.style.position = originalStyles.position;
                element.style.transform = originalStyles.transform;
                
                // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ù„Ø²Ø±
                loadingBtn.textContent = originalText;
                loadingBtn.disabled = false;
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„: ' + error.message);
                
                // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£ØµÙ„ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
                const element = document.getElementById('report');
                if (element && originalStyles) {
                    element.classList.remove('downloading');
                    element.style.height = originalStyles.height;
                    element.style.minHeight = originalStyles.minHeight;
                    element.style.maxHeight = originalStyles.maxHeight;
                    element.style.overflow = originalStyles.overflow;
                    element.style.width = originalStyles.width;
                    element.style.maxWidth = originalStyles.maxWidth;
                    element.style.position = originalStyles.position;
                    element.style.transform = originalStyles.transform;
                }
                
                // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ù„Ø²Ø±
                const loadingBtn = document.querySelector('.download-btn');
                loadingBtn.textContent = 'ğŸ“¸ ØªØ­Ù…ÙŠÙ„ ÙƒØµÙˆØ±Ø©';
                loadingBtn.disabled = false;
            }
        }

        // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù†Øµ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©
        window.addEventListener('beforeprint', function() {
            document.body.style.background = 'white';
        });

        window.addEventListener('afterprint', function() {
            document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
        });
    </script>
</body>
</html>